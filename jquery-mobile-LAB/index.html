<!DOCTYPE html>
<html>
    <head>
		<meta charset="UTF-8" />
		<title>Herry</title>
		<!-- @TODO 1: Ensure you have the meta viewport set -->
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <!-- @TODO 2: Ensure you use the latest version of the jquery mobile styles -->
		<link rel="stylesheet" href="mobile.css" />
        <!-- @TODO 3: Ensure you use the latest version of jquery -->
		<script src="jquery.js"></script>
        <!-- @TODO 4: Ensure you use the latest version of the jquery mobile js -->
        <script src="mobile.js"></script>
	</head>
	<body>
		<div id="page_wrapper">
			<!-- start pages -->
			<!-- @TODO 5:  Give ""ALL"" the pages on this page the correct data-role -->
			<div id="page_one" data-role="page" data-title="Page One Goes Here">
				<div data-role="header">
					<h1>page one</h1>
					<ul>
						<li>
							<a href="#page_one" data-transition="slidefade" data-page="page_one">page one</a>
						</li>
						<li>
							<a href="#page_two" data-transition="slidefade" data-page="page_two">page two</a>
						</li>
						<li>
							<a href="#page_three" rel="external" data-transition="pop" data-page="page_three">this page does not exist</a>
						</li>
					</ul>
				</div>
				<div data-role="content">
					<p>Stuff for page one</p>
                    <!-- @TODO 6:  make this a dialog box when clicked and use a pop transition -->
					<a href="#page_four" data-rel="dialog">my pop out</a>		
					<label for="foo">
					<select name="foo" id="foo">
						<option value="a">A</option>
						<option value="b">B</option>
						<option value="c">C</option>
					</select>
					<label for="flip-1">Select slider:</label>
					<!-- @TODO 7: make this a slider using the correct data-role -->
					<select name="flip-1" id="flip-1" data-role='slider' >
						<option value="off">Off</option>
						<option value="on">On</option>
					</select>
				</div>
				<div data-role="footer">
					<p>&copy; you</p>
				</div>
			</div> <!-- end of page one-->
			<div id="page_two" data-role="page" data-title="Page Two Goes Here">
				<div data-role="header">
					<h1>page two</h1>
					<ul>
						<li>
							<!-- @TODO 8: ensure there is a slidefade transition on this link -->
							<a href="#page_one" data-transition="slidefade" data-page="page_one">page one</a>
						</li>
						<li>
							<a href="#page_two" data-transition="slidefade" data-page="page_two">page two</a>
						</li>
						<li>
							<a href="not_exisits" data-transition="pop" data-page="page_three">this page does not exist</a>			  </li>
					</ul>
				</div>
				<div data-role="content">
					<p>Stuff for page two</p>
				</div>
				<div data-role="footer">
					<p>&copy; you</p>
				</div>
			</div> <!-- end of page two-->
			<div id="page_three" data-role="page">
				<div data-role="header">
					<h1>Page three</h1>
					<ul>
						<li>
							<a href="#page_one" data-transition="slideup" data-page="page_one">page one</a>
						</li>
						<li>
							<a href="#page_two" data-transition="slideup" data-page="page_two">page two</a>
						</li>
						<li>
							<a href="not_exisits" data-transition="pop" data-page="page_three">this page does not exist</a>			</li>
					</ul>
				</div>
				<div data-role="content">
					<p>Stuff for page three</p>
				</div>
				<div data-role="footer">
					<p>&copy; you</p>
				</div>
			</div><!-- end of page three -->
			<div id="page_four" data-role="page" data-title="Page Four Goes Here">
				<div data-role="header">
					<h1>Page three</h1>
					<ul>
						<li>
							<a href="#page_one" data-transition="slideup" data-page="page_one">page one</a>
						</li>
						<li>
							<a href="#page_two" data-transition="slideup" data-page="page_two">page two</a>
						</li>
						<li>
							<a href="not_exisits" data-transition="pop" data-page="page_three">this page does not exist</a>			</li>
					</ul>
				</div>
				<div data-role="content">
					<p>Stuff for page four</p>
				</div>
				<div data-role="footer">
					<p>&copy; you</p>
				</div>
			</div><!-- end of page four -->
			<!-- end pages -->
		</div>
		<script>
		$(document).bind("pagechangefailed", function(pcfe){
			console.log("capturing the page change failed event and inspecting it");
            // @TODO 9: ensure that you inspect the pagechangefailed event in the console
            xxxxxxxxxxxxxxxxxx
		});
		
		
	    // @TODO 10: ensure that you use the correct handler to intercept a page load
		$(document).bind("pagebeforeload", function(pbce, data){
			if(data.toPage[0].id === "page_two"){
				console.log("We are intercepting this pagebeforechange and attempting to hit a fake server and await a JSON response, then fill page three and redirect there instead with new content");
				var response = category_data;
				/// @TODO 11: ensure that you prevent the default action here
                pbce.preventDefault();
                /// @TODO 12: call the drawStuff function and pass the right object as a parameter
				drawStuff(response);			}
		});
		
		function drawStuff(response){
			var html = '',
				  /// @TODO 13: find page three and store it as a variable called $page_three.
                  $page_three = $("#page_three");
			console.log("we could use this object to build out some HTML and insert it");
			console.dir(response);
			html += '<h3>yeh..page three is better so I am showing it instead</h3>';
			
			html += '<ul data-role="listview" >'; // @TODO 14: add a data role of "listview" to this unordered list
				for(var cats in category_data){
					html += '<li><a href="#page_four" data-rel="dialog" data-transition="pop">' + category_data[cats].description + '</a></li>';
				}
			html += '<ul>';
			html += '<p>Try the "this page does not exist link on this page"</p>';
			$("div[data-role^='content']", "#page_three").html(html);
			/// @TODO 15: trigger the page change to $page_three
            $.mobile.changePage($page_three)
		}
		
		// we are using the sample object used in the Jquery mobile example page
		var category_data = {
			animals: {
				name: "Animals",
				description: "All your favorites from aardvarks to zebras.",
				items: [
					{
						name: "Pets"
					},
					{
						name: "Farm Animals"
					},
					{
						name: "Wild Animals"
					}
				]
			},
			colors: {
				name: "Colors",
				description: "Fresh colors from the magic rainbow.",
				items: [
					{
						name: "Blue"
					},
					{
						name: "Green"
					},
					{
						name: "Orange"
					},
					{
						name: "Purple"
					},
					{
						name: "Red"
					},
					{
						name: "Yellow"
					},
					{
						name: "Violet"
					}
				]
			},
			vehicles: {
				name: "Vehicles",
				description: "Everything from cars to planes.",
				items: [
					{
						name: "Cars"
					},
					{
						name: "Planes"
					},
					{
						name: "Construction"
					}
				]
			}
		};

		</script>
	</body>
</html>
